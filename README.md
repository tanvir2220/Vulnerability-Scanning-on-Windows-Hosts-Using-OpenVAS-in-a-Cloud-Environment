<h1>Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment</h1>


<h2>Overview</h2>
The project involves creation of OpenVAS server and client virtual machines (VMs) within the Azure cloud and performing vulnerability scanning on hosts.
<br />

<h2>Environments Used </h2>

- <b>Microsoft Azure</b>
- <b>OpenVAS - Open Vulnerability Assessment Scanner</b>

<h2>To-Do</h2>

To successfully complete the project, we need to perform following tasks:

1.	Create Free Azure Subscription
2.	Prepare OpenVAS Vulnerability Management Scanner 
3.	Create Client Virtual Machine and Make it Vulnerable 
4.	Conducting the First Unauthenticated Scan 
5.	Make Configurations for Credentialed Scans (Within VM) 
6.	Make Configurations for Credentialed Scans (OpenVAS) 
7.	Execute Credentialed Scan against our Vulnerable Windows VM
8.	Remediate Vulnerabilities
9.	Rescan and Verification



<h2>Program Walk-Through</h2>

1.	Create Free Azure Subscription: First of all, I created free Azure Subscription. Make sure you delete the resource group that has all of our resources in it otherwise it will eat up our subscription cost. Here's the link: https://azure.microsoft.com/en-us/free/ . Then login to the Azure Portal. Here's the link: https://portal.azure.com/#home
   
2.	Prepare OpenVAS Vulnerability Management Scanner:

a. Go to Azure Portal

b. Navigate to the Marketplace and search for “OpenVAS secured and supported by HOSSTED”

c. Choose the “Start with a pre-set configuration” option and select the weakest configuration.

d. Click “Continue to Create VM”

e. Configure the VM:

   (1) Resource Group: Vulnerability-Management
   
   (2) VM Name: OpenVAS (Take note of the region and Vnet–consider East US 2)
   
   (3) Authentication: Username → azureuser / Cyberlab123!
   
   (4)Monitoring: Disable Boot Diagnostic
   
f. Click “Create” to create the VM.

g. Once the VM is created, SSH into it using PowerShell (Windows) or Terminal (MacOS) with the provided credentials.

h. Wait until the deployment of OpenVAS is complete.

<p align="center">
<img src="https://i.ibb.co/5WgT1Lx/1.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

<p align="center">
<img src="https://i.ibb.co/SxzSHt8/2.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

3.	Create Client Virtual Machine and Make it Vulnerable:

a. Go to Azure Portal

b. Search for Virtual Machines and create a new Virtual Machine.

c. Configure the VM:

   (1)Resource Group: Vulnerability-Management
   
   (2)VM Name: Win10-Vulnerable
   
   (3)Region: Same as the OpenVAS VM (East US 2)
   
   (4)Virtual Network: Same as OpenVAS
   
   (5)Image: Windows 10 Pro
   
   (6)Size: Any size with 2 vCPUs
   
   (7)Username: azureuser / Cyberlab123!
   
   (8)Networking: Same Vnet as OpenVAS
   
d. Create the VM.

e. Once the VM is created, ensure you can RDP into it with the provided credentials.

f. After logging in, make the VM vulnerable:

   (1)Disable the Windows Firewall
   
   (2)Gather up some Old Software (https://drive.google.com/drive/folders/1n83ilCjZWZulbDdYnUe9wQPK2buY47_U)
   
   (3)Install an Old Version of FireFox: Firefox Setup 97.0b5
   
   (4)Install an Old Version of VLC Player: vlc-1.1.7-win32
   
   (5)Install an Old Version of Adobe Reader: 10.0_AdbeRdr1000_en_US_1_
   
   (6)Restart the VM.

<p align="center">
<img src="https://i.ibb.co/BVH4FtF/3.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

4.	Conducting the First Unauthenticated Scan:

a. Login to OpenVAS and navigate to Assets > Hosts > New Host.

b. Add the Client VM PRIVATE IP Address.

c. Create a New Target from the Host, name it “Azure Vulnerable VMs”.

d. Take note of the credentials. We will add SMB credentials later.

e. Create a new Task:

   (1)Name & Comment: “Scan — Azure Vulnerable VMs”
   
   (2)Scan Targets: “Azure Vulnerable VMs”
   
f. Save the Task.

g. Start the “Scan — Azure Vulnerable VMs” Task.

h. Once the scan is finished, click the date under “Last Report” to see the results.

i. Take note of the Tabs, especially the “Results” tab.

<p align="center">
<img src="https://i.ibb.co/2hRvtXS/4.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

5.	Make Configurations for Credentialed Scans (Within VM):

a. Disable Windows Firewall.

b. Disable User Account Control.

c. Enable Remote Registry.

d. Set Registry Key:

   (1)Launch Registry Editor (regedit.exe) in “Run as administrator” mode.

   (2)Navigate to HKEY_LOCAL_MACHINE hive.

   (3)Open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key.

   (4)Create a new DWORD (32-bit) value with the following properties:

   (5)Name: LocalAccountTokenFilterPolicy

   (6)Value: 1

   (7)Close Registry Editor.

e. Restart the VM.

<p align="center">
<img src="https://i.ibb.co/YB71JYt/5.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

6.	Make Configurations for Credentialed Scans (OpenVAS):

a. Go to Configuration > Credentials > New Credential.

b. Name / Comment: “Azure VM Credentials”.

c. Allow Insecure Use: Yes.

d. Username: azureuser.

e. Password: Cyberlab123!

f. Save.

g. Go to Configuration > Targets > CLONE the Target we made before.

h. NEW Name / Comment: “Azure Vulnerable VMs — Credentialed Scan”.

i. Ensure the Private IP is still accurate.

j. Credentials > SMB > Select the Credentials we just made: Azure VM Credentials.

k. Save.

<p align="center">
<img src="https://i.ibb.co/LNF1Wh9/6.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

7.	Execute Credentialed Scan against our Vulnerable Windows VM:

a. Within Greenbone / OpenVAS, go to Scans > Tasks.

b. CLONE the “Scan — Azure Vulnerable VMs” Task and Edit it.

c. Name / Comment: “Scan — Azure Vulnerable VMs — Credentialed”.

d. Targets: Azure Vulnerable VMs — Credentialed Scan.

e. Save.

f. Click the Play button to launch the new Credentialed Scan and wait for it to finish.

<p align="center">
<img src="https://i.ibb.co/pjpwypP/7.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

<p align="center">
<img src="https://i.ibb.co/F7NX5qn/8.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />

8.	Remediate Vulnerabilities: Having identified the vulnerabilities, our next step is to initiate remediation efforts. This process involves addressing the vulnerabilities to reduce or eliminate the associated risks. Remediation measures might include applying security patches, reconfiguring systems, updating software, or implementing security best practices. Now we log back into the Win10-Vulnerable VM and uninstall Adobe Reader, VLC Player, and Firefox, and then Restart the VM.

9.	Rescan and Verification: Note that there are no longer Vulnerabilities for FireFox, VLC Player, or Adobe Reader!

<p align="center">
<img src="https://i.ibb.co/8BCYMX6/9.jpg" height="80%" width="80%" alt="Vulnerability Scanning on Windows Hosts Using OpenVAS in a Cloud Environment"/>
<br />
<br />
